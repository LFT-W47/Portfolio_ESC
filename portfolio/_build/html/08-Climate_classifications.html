
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Climate classifications &#8212; Portfolio Earth System Components Winter term 2022/23</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Teleconnections: Global correlation maps with the Nino3.4 index" href="06-Global_correlation_maps.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/pic.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Portfolio Earth System Components Winter term 2022/23</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the Portfolio for the course Earth System Components Winter term 2022/23
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="first.html">
   Question 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="second.html">
   How does ozone interact with UV radiation i.e. what is the physical-chemical reaction behind that interaction?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="third.html">
   NAO &amp; AO
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fourth.html">
   What mechanisms explain the existence of ocean gyres?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_intro_ext.html">
   Introduction to JupyterLab, Python and Conda
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Energy-balance.html">
   The Energy balance of the earth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-Introduction-to-xarray.html">
   Xarray and how to explore variables in the Earth System Data Cube
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-Computation-concepts.html">
   Computation concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05-Anomalies.html">
   Anomalies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06-Global_correlation_maps.html">
   Teleconnections: Global correlation maps with the Nino3.4 index
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Climate classifications
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/LFT-W47/Portfolio_ESC/master?urlpath=tree/docs/08-Climate_classifications.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/LFT-W47/Portfolio_ESC"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/LFT-W47/Portfolio_ESC/issues/new?title=Issue%20on%20page%20%2F08-Climate_classifications.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/08-Climate_classifications.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#climate-classification-based-on-gpp">
   Climate classification based on GPP
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Climate classifications</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#climate-classification-based-on-gpp">
   Climate classification based on GPP
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="climate-classifications">
<h1>Climate classifications<a class="headerlink" href="#climate-classifications" title="Permalink to this headline">#</a></h1>
<p>Climate classes are a way of grouping different areas of the world based on their climate, or the average weather conditions in a specific region over a long period of time. Climate classes are used in many fields, including agriculture, forestry, and urban planning, to help understand the unique weather patterns and natural resources of an area and how they may impact human activities.</p>
<p>There are many different ways to classify climate, but one of the most widely used systems is the Köppen-Geiger climate classification system, which was developed in the late 1800s by German climatologist Wladimir Köppen. The Köppen-Geiger system categorizes climates into five main groups: tropical, dry, temperate, continental, and polar. Within each of these groups, there are subcategories based on specific temperature and precipitation patterns.</p>
<p>Climate classes are useful because they provide a standardized way of comparing and understanding the weather patterns of different regions. They allow us to identify areas with similar climates and make informed decisions about how to best use and manage natural resources in those regions. For example, a farmer in a tropical climate may need to consider different crops and irrigation strategies than a farmer in a dry climate. Similarly, an urban planner designing a city in a temperate climate may need to consider different building materials and energy efficiency measures than a planner in a polar climate.</p>
<p>Overall, climate classes are an important tool for understanding and adapting to the unique conditions of different regions around the world.</p>
<section id="climate-classification-based-on-gpp">
<h2>Climate classification based on GPP<a class="headerlink" href="#climate-classification-based-on-gpp" title="Permalink to this headline">#</a></h2>
<p>Gross primary productivity (GPP) refers to the rate at which plants produce organic matter through photosynthesis. It is an important measure of the health and productivity of an ecosystem, and is often used to understand how different climate conditions impact the growth and productivity of plants.</p>
<p>One way in which GPP can be used to generate climate classes is by looking at the relationship between GPP and temperature. In general, plants tend to have higher GPP in warmer temperatures, as they are able to photosynthesize more efficiently at higher temperatures. However, there is a point at which temperatures become too high and plants begin to experience stress, leading to decreased GPP. By analyzing the relationship between GPP and temperature in different regions, it is possible to identify areas with similar climates and group them into distinct climate classes.</p>
<p>Another way in which GPP can be used to generate climate classes is by looking at the relationship between GPP and precipitation. In general, plants tend to have higher GPP in areas with sufficient water availability, as water is necessary for photosynthesis and plant growth. By analyzing the relationship between GPP and precipitation in different regions, it is possible to identify areas with similar climates and group them into distinct climate classes.</p>
<p>Overall, GPP is a useful tool for understanding the impacts of different climate conditions on plant growth and productivity, and can be used to generate climate classes based on temperature and precipitation patterns in different regions.</p>
<p><strong>TODO: Generate a map with climate classes based on GPP. The classes should be assigned according to the water and energy availability (whether temperature and precipitation are at the time of maximal GPP higher or lower than the annual mean in this location). Temperature and precipitation are interpreted as the driving climate factors since they set the water and energy limitations.</strong></p>
<p><strong>Therefore, determine a mean seasonal cycle of each location. Pick the day of the year in which GPP is at its maximum. Prepare a classification of 4 classes according to energy and water availability (are temperature and precipitation higher or lower than the average at this location).</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">fsspec</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Open the dataset</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_zarr</span><span class="p">(</span><span class="n">fsspec</span><span class="o">.</span><span class="n">get_mapper</span><span class="p">(</span><span class="s1">&#39;/work/users/gy963viny/public/EarthSystemDataCube/v2.1.1/esdc-8d-0.25deg-184x90x90-2.1.1.zarr/&#39;</span><span class="p">),</span> \
                  <span class="n">consolidated</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extracting GPP, Temperature and Precipitation</span>
<span class="n">gpp_mean</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">gross_primary_productivity</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.dayofyear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">temp_mean</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">air_temperature_2m</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.dayofyear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">precip_mean</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">precipitation</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.dayofyear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Max of GPP</span>
<span class="n">max_gpp</span> <span class="o">=</span> <span class="n">gpp_mean</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_gpp</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x145887362ca0&gt;
</pre></div>
</div>
<img alt="_images/08-Climate_classifications_6_1.png" src="_images/08-Climate_classifications_6_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Actual Time from max of GPP</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">gpp_mean</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x145886bf6ac0&gt;
</pre></div>
</div>
<img alt="_images/08-Climate_classifications_8_1.png" src="_images/08-Climate_classifications_8_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extracting Temperature and Precipitation at the actual time of GPP max</span>
<span class="n">temp_at_doy</span> <span class="o">=</span> <span class="n">temp_mean</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">temp_mean</span><span class="p">[</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">mask</span><span class="p">)</span>
<span class="n">temp_at_doy</span> <span class="o">=</span> <span class="n">temp_at_doy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">precip_at_doy</span> <span class="o">=</span> <span class="n">precip_mean</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">precip_mean</span><span class="p">[</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">mask</span><span class="p">)</span>
<span class="n">precip_at_doy</span> <span class="o">=</span> <span class="n">precip_at_doy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_at_doy</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x1458874ae940&gt;
</pre></div>
</div>
<img alt="_images/08-Climate_classifications_10_1.png" src="_images/08-Climate_classifications_10_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">precip_at_doy</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x145886a3b130&gt;
</pre></div>
</div>
<img alt="_images/08-Climate_classifications_11_1.png" src="_images/08-Climate_classifications_11_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Temperature and Precipitation annual mean</span>
<span class="n">temp_mean_annual</span> <span class="o">=</span> <span class="n">temp_mean</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">precip_mean_annual</span> <span class="o">=</span> <span class="n">precip_mean</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># filling classification with different arrays which have 4 values </span>
<span class="n">classification</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="p">(</span><span class="n">temp_at_doy</span> <span class="o">&gt;</span> <span class="n">temp_mean_annual</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">precip_at_doy</span> <span class="o">&gt;</span> <span class="n">precip_mean_annual</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="c1"># &quot;Warm and Wet&quot;</span>
                 <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">temp_at_doy</span> <span class="o">&lt;</span> <span class="n">temp_mean_annual</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">precip_at_doy</span> <span class="o">&lt;</span> <span class="n">precip_mean_annual</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># &quot;Cool and Dry&quot;</span>
                 <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">temp_at_doy</span> <span class="o">&gt;</span> <span class="n">temp_mean_annual</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">precip_at_doy</span> <span class="o">&lt;</span> <span class="n">precip_mean_annual</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="c1"># &quot;Warm and Dry&quot;</span>
                 <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">temp_at_doy</span> <span class="o">&lt;</span> <span class="n">temp_mean_annual</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">precip_at_doy</span> <span class="o">&gt;</span> <span class="n">precip_mean_annual</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="c1"># &quot;Cool and Wet&quot;</span>
                 <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">temp_mean_annual</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)))))</span> <span class="c1"># NaN where at the pixels with no values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># colormap</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">]</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

<span class="c1"># actual plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">classification</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s2">&quot;Warm and Wet&quot;</span><span class="p">,</span> <span class="s2">&quot;Cool and Dry&quot;</span><span class="p">,</span> <span class="s2">&quot;Warm and Dry&quot;</span><span class="p">,</span> <span class="s2">&quot;Cool and Wet&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;4 Climate Classes GPP&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;4 Climate Classes GPP&#39;)
</pre></div>
</div>
<img alt="_images/08-Climate_classifications_14_1.png" src="_images/08-Climate_classifications_14_1.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "fin"
        },
        kernelOptions: {
            kernelName: "fin",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'fin'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="06-Global_correlation_maps.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Teleconnections: Global correlation maps with the Nino3.4 index</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Louis Trinkle<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>